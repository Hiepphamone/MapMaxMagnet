print("AAAAAAAAAAAAAAAAAAAAA")
repeat wait(1) until game.Players
repeat wait(1) until game.Players.LocalPlayer
repeat wait(1) until game.ReplicatedStorage
repeat wait(1) until game:GetService("Players").LocalPlayer:FindFirstChild("PlayerGui")
repeat wait(1) until game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("Main")
local vu = game:GetService("VirtualUser")
local plr = game.Players.LocalPlayer
local Client = require(game.ReplicatedStorage.Library.Client)

function getlastmap()
    return Client.ZoneCmds.GetMaxOwnedZone()
end

function formatmap(text)
    local result = string.match(text, "| (.*)$")
    return result
end

function jump()
    game:GetService("VirtualInputManager"):SendKeyEvent(true, 32, false, game)
    wait(4)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, 32, false, game)
end
function formatclient(name)
    local pattern = " table: .*$"
    local result = name:gsub(pattern, "") 
    return result
end

function getlocation()
    for i,v in pairs(workspace.Map:GetChildren()) do
        if formatmap(v.Name) == formatclient(getlastmap()) then
            return v.INTERACT.BREAK_ZONES.BREAK_ZONE
        end
    end
    return false
end

function getflag()
    for i,v in pairs(Client.InventoryCmds.State().container._store._byType.Misc._byUID) do
        if v._data.id == "Magnet Flag" then
            return {v._data.id,i}
        end
    end
end

function attack()
    local a = {}
    for i,v in pairs(game:GetService("Workspace")["__THINGS"].Breakables:GetChildren()) do
        for i1,v1 in pairs(v:GetChildren()) do
            if (v1.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude < 60 and #a < 2 then
                return v.Name
            end
        end
    end
end

function autofarm()
    if (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - CFrame.new(214.46041870117188, 27.29428482055664, -588.5107421875).Position).Magnitude > 10 and getgenv().camco == false then
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(214.46041870117188, 27.29428482055664, -588.5107421875)
    end
end

spawn(function()
    while true do wait()
        pcall(autofarm)
    end
end)

spawn(function()
    while true do wait()
        pcall(function()
            local tickm = tick()
            repeat wait()
            until tick() - tickm >= 30
            jump()
        end)
    end
end)

function getuid(name)
    for i,v in pairs(Client.InventoryCmds.State().container._store._byType.Misc._byUID) do
        if v._data.id == name then
            return i 
        end
    end
    return false
end

spawn(function()
    while true do wait(30)
        pcall(function()
            getgenv().camco = true
            local args = {
            [1] = formatclient(getlastmap())
            }
            
            game:GetService("ReplicatedStorage").Network.Teleports_RequestTeleport:InvokeServer(unpack(args))
            wait(10)
            plr.Character.HumanoidRootPart.CFrame = getlocation().CFrame
            Client.ZoneFlagCmds.Consume(getflag()[1],getflag()[2])
            if getuid("Comet") then
                local args = {
                    [1] = getuid("Comet")
                }
                
                game:GetService("ReplicatedStorage").Network.Comet_Spawn:InvokeServer(unpack(args))
            end
            wait(5)
            getgenv().camco = false
        end)
    end
end)
